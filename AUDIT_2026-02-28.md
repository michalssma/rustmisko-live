# SYSTEM AUDIT â€” RustMiskoLive

**Datum:** 2026-02-28 00:30 UTC  
**ÃšÄel:** FinÃ¡lnÃ­ audit pro Gemini + GPT review celÃ©ho systÃ©mu  
**Stav:** PRODUKCE â€” systÃ©m bÄ›Å¾Ã­ 24/7, auto-bet aktivnÃ­  
**Mise:** PasivnÃ­ pÅ™Ã­jem $2,000â€“3,000/mÄ›sÃ­c pÅ™es Azuro protocol

---

## 1. ARCHITEKTURA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tampermonkey    â”‚â”€â”€â”€â”€â–¶â”‚    feed-hub      â”‚â”€â”€â”€â”€â–¶â”‚  alert-bot   â”‚
â”‚  Scrapers (4x)  â”‚ WS  â”‚  (Rust, 1804 Å™.) â”‚ HTTPâ”‚ (Rust, 4878Å™)â”‚
â”‚                  â”‚     â”‚  port 8080/8081   â”‚     â”‚  auto-bet    â”‚
â”‚  â€¢ Tipsport     â”‚     â”‚                  â”‚     â”‚  claim/cash  â”‚
â”‚  â€¢ Chance        â”‚     â”‚  â€¢ /state        â”‚     â”‚  Telegram    â”‚
â”‚  â€¢ HLTV          â”‚     â”‚  â€¢ /opportunitiesâ”‚     â”‚              â”‚
â”‚  â€¢ FlashScore    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
                                                         â”‚ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Azuro Poller   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   executor   â”‚
â”‚  (Rust, 648 Å™.) â”‚  GraphQL subgraph â†’ odds      â”‚  (Node.js)   â”‚
â”‚  12 sportÅ¯, 5s  â”‚                               â”‚  port 3030   â”‚
â”‚                  â”‚                               â”‚              â”‚
â”‚  â€¢ match_winner  â”‚                               â”‚  â€¢ /bet      â”‚
â”‚  â€¢ map_winner    â”‚                               â”‚  â€¢ /claim    â”‚
â”‚  â€¢ totals        â”‚                               â”‚  â€¢ /my-bets  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â€¢ /balance  â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Komponenty

| Komponenta | Soubor | Stav | Popis |
|-----------|--------|------|-------|
| **alert-bot** | `src/bin/alert_bot.rs` (6552 Å™.) | âœ… RUNNING | HlavnÃ­ mozek â€” edge detekce, auto-bet, claim, Telegram |
| **feed-hub** | `src/feed_hub.rs` (1804 Å™.) | âœ… RUNNING | WS ingest, fÃºze dat, sport modely, REST API |
| **executor** | `executor/index.js` | âœ… RUNNING (port 3030) | On-chain operace â€” bet, claim, balance, NFT enumeration |
| **azuro_poller** | `src/azuro_poller.rs` (648 Å™.) | âœ… RUNNING | GraphQL polling Azuro subgraph â†’ odds do feed-hub |
| **Tipsport scraper** | `userscripts/tipsport_odds_scraper.user.js` (v3.0) | âœ… ACTIVE | Live odds + scores + `detailed_score` |
| **Chance scraper** | `userscripts/chance_live_scraper.user.js` (v1.1, 827 Å™.) | âœ… ACTIVE | `detailed_score` pro CS2 round data (sety, mapy, kola) |
| **HLTV scraper** | `userscripts/hltv_live_scraper.user.js` (v3.1, 516 Å™.) | âœ… ACTIVE | CS2 live skÃ³re + odds |
| **FlashScore scraper** | `userscripts/flashscore_multisport_scraper.user.js` | âœ… ACTIVE | Multi-sport live data |

### Chain / Kontrakty (Polygon 137)

| Co | Adresa |
|----|--------|
| Wallet | `0x8226D38e5c69c2f0a77FBa80e466082B410a8F00` |
| USDT | `0xc2132D05D31c914a87C6611C10748AEb04B58e8F` |
| AzuroBet NFT | `0x7A1c3FEf712753374C4DCe34254B96faF2B7265B` |
| LiveCore | `0xF9548Be470A4e130c90ceA8b179FCD66D2972AC7` |
| LP Pool | `0x0FA7FB5407eA971694652E6E16C12A52625DE1b8` |
| ProxyFront (Relayer) | `0x8dA05c0021e6b35865FDC959c54dCeF3A4AbBa9d` |

---

## 2. PORTFOLIO SNAPSHOT (2026-02-28 00:30 UTC)

| Metrika | Hodnota |
|---------|---------|
| **USDT Balance** | **$53.14** |
| **Celkem NFT betÅ¯** | 84 |
| Pending (ÄekajÃ­ na vÃ½sledek) | 55 |
| Lost (prohranÃ©) | 29 |
| Claimable | 0 |
| Pending claims v pipeline | 13 |

### HistorickÃ¡ performance (od spuÅ¡tÄ›nÃ­)

| Metrika | Hodnota |
|---------|---------|
| Celkem wagered (historicky) | ~$252+ |
| Celkem returned (won + canceled) | ~$216+ |
| Peak balance | $75.51 |
| Current balance | $53.14 |
| Overall ROI (67 settled betÅ¯) | **+12.56%** |

### Daily PNL (2026-02-27)

```
wagered:  $9.00 (3 bety Ã— $3.00)
returned: $40.63 (z dÅ™Ã­vÄ›jÅ¡Ã­ch vyher)
net:      +$31.63 (vrÃ¡ceno vÃ­c neÅ¾ vsazeno dnes)
```

---

## 3. AUTO-BET STRATEGIE (v5.1)

### 3.1 Score Edge Detection

**Jak funguje:** Alert-bot kaÅ¾dÃ© 2s polluje feed-hub `/opportunities`. Feed-hub porovnÃ¡vÃ¡ LIVE skÃ³re (Tipsport/Chance/HLTV) s Azuro odds (subgraph). Pokud skÃ³re implikuje jinou pravdÄ›podobnost neÅ¾ kurzy â†’ EDGE.

```
edge% = (estimated_fair_prob - azuro_implied_prob) * 100 * cross_validation_multiplier
```

**Sport-specifickÃ© konfigurace:**

| Sport | Min Edge | Stake | Preferred Market | Extra Guard |
|-------|----------|-------|-----------------|-------------|
| CS2/Esports | 12% | $3.00 | match_or_map | â€” |
| Tennis | 15% | $1.00 (data-collection) | match_winner | â€” |
| Basketball | 12% | $1.00 (data-collection) | match_winner | â€” |
| Football | 18% | $3.00 | match_winner | â€” |
| Volleyball/Hockey/etc. | 15% | $1.00 | match_winner | â€” |

### 3.2 Odds Anomaly Detection

**Jak funguje:** PorovnÃ¡nÃ­ kurzÅ¯ mezi 2+ bookmakery. Pokud Azuro nabÃ­zÃ­ vÃ½raznÄ› jinÃ½ kurz neÅ¾ Tipsport/Chance â†’ anomÃ¡lie.

| Parametr | Hodnota |
|----------|---------|
| MinimÃ¡lnÃ­ zdroje | 2 (vyÅ¾aduje â‰¥2 bookmakery) |
| Stake | $2.00 |
| Odds range | 1.15â€“2.00 (CS2 map: aÅ¾ 3.00) |

### 3.3 KlÃ­ÄovÃ© konstanty

```rust
// ObecnÃ©
POLL_INTERVAL_SECS = 2          // freq. pollovÃ¡nÃ­ feed-hub
AUTO_BET_ENABLED = true
AUTO_BET_STAKE_USD = 3.0        // base stake (esports, football)
AUTO_BET_STAKE_LOW_USD = 1.0    // data-collection stake (tennis, basketball)

// Odds limity
AUTO_BET_MIN_ODDS = 1.15        // Å¾Ã¡dnÃ­ tÄ›Å¾cÃ­ favoriti
AUTO_BET_MAX_ODDS = 2.00        // Å¾Ã¡dnÃ­ extreme underdogs
AUTO_BET_MAX_ODDS_CS2_MAP = 3.00 // CS2 map_winner vÃ½jimka

// Edge thresholds
MIN_EDGE_PCT = 5.0              // min pro alert
MIN_SCORE_EDGE_PCT = 8.0        // min pro score edge alert

// Safety
AUTO_BET_MIN_MARKET_SOURCES = 2 // odds anomaly: min 2 bookmakery
DAILY_LOSS_LIMIT_USD = 20.0     // dennÃ­ stop-loss
MAX_ODDS_AGE_SECS = 20          // ignoruj stale odds
WATCHDOG_TIMEOUT_SECS = 120     // safe mode bez feed-hub dat

// Retry/slippage
AUTO_BET_RETRY_MAX = 8          // max retry na live markety
AUTO_BET_RETRY_SLEEP_MS = 900
MIN_ODDS_FACTOR_DEFAULT = 0.97  // 3% slippage tolerance

// Claim
CLAIM_CHECK_SECS = 60           // check claimable kaÅ¾dÃ½ch 60s
PORTFOLIO_REPORT_SECS = 1800    // Telegram report kaÅ¾dÃ½ch 30min
```

---

## 4. NOVÃ‰ UPGRADY (nasazeno 2026-02-27)

### 4.1 Exposure Caps (FF_EXPOSURE_CAPS = true)

**DynamickÃ© bankroll-based caps:**

| Tier | Bankroll | Per-Bet | Per-Condition | Per-Match | Daily Loss |
|------|----------|---------|---------------|-----------|-----------|
| Micro | <$150 | 5% | 10% | 15% | 30% |
| Small | $150â€“500 | 3% | 8% | 12% | 20% |
| Medium | $500â€“1500 | 2% | 6% | 10% | 15% |
| Large | $1500+ | 1.5% | 5% | 8% | 10% |

**PÅ™i $53 bankrollu (micro tier):**
- Per-bet max: $2.65 (5% Ã— $53)
- Per-condition max: $5.30 (10% Ã— $53)
- Per-match max: $7.95 (15% Ã— $53)
- Daily loss max: $15.90 (30% Ã— $53)

**Implementace:** `trim_stake()` funkce bere `(calculated_stake, bankroll, condition_exposure, match_exposure, daily_loss)` â†’ vracÃ­ safe stake nebo 0.0 pokud <$0.50.

### 4.2 Re-Bet Tracking (FF_REBET_ENABLED = true)

**UmoÅ¾Åˆuje multiple bets na stejnou condition pokud se edge zvÄ›tÅ¡uje:**

```rust
fn rebet_allowed(state, new_tier, new_edge) -> bool {
    state.bet_count < 3           // max 3 bety na condition
    && elapsed >= 30              // min 30s cooldown
    && (tier_improved || edge_jumped >= 8.0)  // tier upgrade NEBO edge +8%
}
```

**Tiers:** LOW â†’ MEDIUM â†’ HIGH â†’ ULTRA

### 4.3 CS2 Round Parser (FF_CHANCE_ROUND_PARSER = true)

**Parsuje `detailed_score` z Chance scraperu:**

```
Input:  "2:1LepÅ¡Ã­ z 5 | 4. mapa - 11:3"
Output: map_score=(2,1), current_map=4, round_score=(11,3)
```

**Funkce:**
- `parse_cs2_round_score(detailed)` â†’ `Option<(i32,i32)>`
- `parse_cs2_current_map(detailed)` â†’ `Option<u8>`
- `parse_cs2_completed_maps(detailed)` â†’ `Vec<(i32,i32)>`

### 4.4 Cross-Validation (FF_CROSS_VALIDATION = true)

**PorovnÃ¡nÃ­ HLTV vs Chance round scores:**

```rust
fn cross_validation_multiplier(hltv, chance) -> f64 {
    Both agree     â†’ 1.25  // 25% edge boost
    Mismatch       â†’ 0.0   // HARD SKIP (stale data risk)
    Only one source â†’ 1.0  // neutral
}
```

**Aplikace:** Aplikuje se v `find_score_edges()` na VÅ ECHNY edge vÃ½poÄty (match_winner i map_winner).

### 4.5 Cross-Map Momentum (FF_CROSS_MAP_MOMENTUM = true)

**Bonus +3% pro tÃ½m dominantnÃ­ v pÅ™edchozÃ­ch mapÃ¡ch:**

```rust
fn cross_map_momentum_bonus(completed_maps, leading_side) -> f64 {
    // Pokud tÃ½m vyhrÃ¡l VÅ ECHNY pÅ™edchozÃ­ mapy s 16-X kde X<10 â†’ +0.03
    // Jinak â†’ 0.0
}
```

---

## 5. SAFETY LAYERS (kompletnÃ­ seznam)

### Layer 1: VstupnÃ­ filtry
- âœ… Odds range: 1.15â€“2.00 (CS2 map: 1.15â€“3.00)
- âœ… Min market sources: 2 pro anomÃ¡lie
- âœ… Max odds age: 20s (ignoruj stale snapshots)
- âœ… Sport-specific min edge: 12% (esports) aÅ¾ 18% (football)

### Layer 2: Dedup & Cooldowns
- âœ… Per-condition dedup: nikdy 2 bety na stejnou condition (bez re-bet upgrade)
- âœ… Score edge cooldown: 30s per match
- âœ… Alert cooldown: 45s per match+score+side
- âœ… Inflight lock: race condition ochrana

### Layer 3: Exposure Management
- âœ… Per-bet cap (5% bankrollu @ micro tier)
- âœ… Per-condition cap (10%)
- âœ… Per-match cap (15%)
- âœ… Daily loss cap (30% bankrollu NEBO $20 hard limit)
- âœ… Min stake $0.50 (pod tÃ­m â†’ skip)

### Layer 4: Data Quality
- âœ… Cross-validation HLTV vs Chance (mismatch â†’ skip)
- âœ… Watchdog: 120s bez feed-hub dat â†’ SAFE MODE (no bets)
- âœ… Manual alert max age: 25s (prevents stale triggers)

### Layer 5: Settlement Safety
- âœ… Claim pre-filter: ovÄ›Å™Ã­ `/check-payout` (claimable && !pending) PÅ˜ED claim tx
- âœ… Azuro relayer auto-claim (7d timeout, my jsme backup)
- âœ… Safe auto-prune: won/canceled â†’ prune jen po viewPayout==0 ovÄ›Å™enÃ­
- âœ… Permanent ledger (`data/ledger.jsonl`) â€” append-only, 12 event types

### Layer 6: Feature Flags
- âœ… VÅ¡ech 5 feature flagÅ¯ = `true`
- UmoÅ¾Åˆuje rychlÃ½ rollback jednotlivÃ½ch upgradÅ¯ v produkci

---

## 6. DATA FLOW & VERIFIED INTEGRATIONS

### 6.1 Tipsport â†’ feed-hub
âœ… Live skÃ³re + odds pro vÅ¡echny sporty, `detailed_score` pole

### 6.2 Chance â†’ feed-hub
âœ… `detailed_score` s CS2 round daty  
PÅ™Ã­klad: `"2:1LepÅ¡Ã­ z 5 | 4. mapa - 11:3"` â†’ parsovÃ¡no na map=(2,1), round=(11,3), current_map=4

OvÄ›Å™eno v produkci (28.2. 00:00 UTC):
- `esports::liquid_vs_lyon | detailed: 2:1LepÅ¡Ã­ z 5 | 4. mapa`
- `esports::evoker_vs_vortex | detailed: 0:0LepÅ¡Ã­ z 1 | 1.mapa - 11:1`
- Tennis, football, basketball detailed scores all flowing

### 6.3 HLTV â†’ feed-hub
âœ… CS2 map scores + odds, cross-validated s Chance daty

### 6.4 Azuro Subgraph â†’ feed-hub
âœ… 12 sportÅ¯, `first: 100`, 5s interval, LIVE markety  
Typicky 15â€“20 Azuro markets v Å¾ivÃ©m provozu (zÃ¡visÃ­ na dennÃ­ dobÄ›)

### 6.5 feed-hub â†’ alert-bot
âœ… HTTP polling `/opportunities` a `/state` kaÅ¾dÃ© 2s

### 6.6 alert-bot â†’ executor
âœ… HTTP POST `/bet`, `/claim`, `/check-payout`, `/balance`, `/my-bets`

### 6.7 alert-bot â†’ Telegram
âœ… Alerting, portfolio reports, auto-bet notifications, error alerting

---

## 7. NFT AUDIT (2026-02-28 00:00 UTC)

### 7.1 On-Chain Stav

| Kategorie | PoÄet | Detaily |
|-----------|-------|---------|
| **Pending** | 55 | Genuinely ÄekajÃ­ na vÃ½sledek â€” ovÄ›Å™eno `/check-payout` kaÅ¾dÃ½ token |
| **Lost** | 29 | Confirmed $0 payout â€” ovÄ›Å™eno `/check-payout` kaÅ¾dÃ½ token |
| **Claimable** | 0 | Nic k vyzvednutÃ­ |
| **Stuck** | 0 | Å½Ã¡dnÃ© stuck tokeny |
| **TOTAL** | 84 | â€” |

### 7.2 Special Case: Token 221833

- Bet: Crashers map3_winner @ 2.07 ($3)
- Status: Subgraph hlÃ¡sÃ­ "Canceled" ale chain jeÅ¡tÄ› nezpracoval
- Akce: Re-added do `pending_claims.txt`, auto-claim se pokusÃ­ vyzvednout $3 refund
- Risk: NulovÃ½ â€” buÄ se claimne nebo relayer zpracuje automaticky

### 7.3 Verdikt

**ğŸŸ¢ ÄŒISTÃ‰ â€” Å¾Ã¡dnÃ© penÃ­ze stuck, Å¾Ã¡dnÃ© missed vÃ½platy, Å¾Ã¡dnÃ© ztracenÃ© NFTs**

---

## 8. OVERNIGHT TRADING ANALÃZA (post-deploy)

### 8.1 Aktivita od nasazenÃ­ upgradÅ¯ (23:43 â†’ 00:30 UTC)

| Metrika | Hodnota | VysvÄ›tlenÃ­ |
|---------|---------|-----------|
| Score EDGE detekovÃ¡no | 69 | Startup scan + live |
| AUTO-BET placed | 0 | Å½Ã¡dnÃ© qualifying oportunities |
| AUTO-BET blocked | 0 | â€” |
| SPORT GUARD blocked | 0 | â€” |
| NO AZURO ODDS | 46 | Live zÃ¡pasy bez Azuro marketÅ¯ |
| Not actionable (low edge) | 29 | Score diff pÅ™Ã­liÅ¡ malÃ½ |
| DEDUP blocked | 1 | Existing bet detected |
| Anomaly skipped (1 src) | 3 | Single bookmaker only |
| EXPOSURE CAP triggered | 0 | â€” |
| RE-BET triggered | 0 | â€” |
| CROSS-MAP MOMENTUM | 0 | â€” |
| CROSS-VALIDATION | 0 | Å½Ã¡dnÃ½ CS2 round-level edge |

### 8.2 KonkrÃ©tnÃ­ pÅ™Ã­leÅ¾itosti

1. **football::melgar_vs_chankas** â€” 1-0, edge 9.6%
   - Football guard vyÅ¾aduje 18% min edge â†’ **ne-kvalifikuje se** (9.6% < 18%)
   
2. **esports::fluxo_vs_oddik** â€” 6-1 map2_winner, edge **-26.3%**
   - ZÃ¡pornÃ½ edge = Å¡patnÃ¡ strana â†’ **sprÃ¡vnÄ› skipnuto**
   
3. **esports::liquid_vs_lyon** â€” 2-1, odds anomÃ¡lie (Azuro 23% vs Tipsport 39%)
   - Pouze 1 market source (Azuro) â†’ **sprÃ¡vnÄ› skipnuto** (needs 2)

### 8.3 Root Cause Analysis: 0 Auto-BetÅ¯

**SystÃ©m NENÃ pÅ™eÅ¡krcenÃ½.** Root cause:

1. **ÄŒasovÃ¡ zÃ³na**: Midnight UTC = JiÅ¾nÃ­ Amerika+Maroko+AustrÃ¡lie â€” nÃ­zkÃ½ overlap s Azuro markety
2. **87 live zÃ¡pasÅ¯** ale jen **17 Azuro odds items** â†’ jen 1 cross-match (liquid_vs_lyon, diff=1)
3. **PÅ™es den** (14:00â€“22:00 UTC) je typicky 10â€“30Ã— vÃ­c Azuro marketÅ¯ s EvropskÃ½mi CS2/footballem

### 8.4 Verdikt

**ğŸŸ¢ SYSTÃ‰M JE READY â€” bude obchodovat jakmile budou qualifying pÅ™Ã­leÅ¾itosti (pÅ™edpoklÃ¡danÄ› dnes odpoledne CET)**

---

## 9. PERFORMANCE ROI BY SPORT (67 settled betÅ¯)

| Sport | n | ROI | Status |
|-------|---|-----|--------|
| **Esports** | 8 | **+33.5%** | âœ… Core profit driver |
| **CS2** | 13 | **+19.3%** | âœ… Core profit driver |
| **Football** | 9 | +13.3% | âœ… Profitable |
| **Basketball** | 13 | -9.5% | âš ï¸ Data-collection ($1 stake) |
| **Tennis** | 5 | -35.6% | âš ï¸ Data-collection ($1 stake) |

| Odds Bucket | ROI | Akce |
|-------------|------|------|
| 2.0â€“3.0 | **+29.6%** | âœ… NejlepÅ¡Ã­ bucket |
| 1.5â€“2.0 | **+18.9%** | âœ… HlavnÃ­ range |
| <1.5 | -14.9% | âŒ Hard cap MIN_ODDS=1.15 |
| >=3.0 | -45.4% | âŒ Hard cap MAX_ODDS=2.00 (CS2 map: 3.00) |

---

## 10. KNOWN ISSUES & RISKS

### 10.1 AktivnÃ­ Issues

| # | Severity | Popis | Mitigace |
|---|----------|-------|----------|
| 1 | LOW | Token 221833 ÄekÃ¡ na on-chain resolve | Auto-retry v claim pipeline |
| 2 | LOW | Balance klesÃ¡ ($75â†’$53) kvÅ¯li 55 pending betÅ¯m | OÄekÃ¡vanÃ© â€” vyhranÃ© se vrÃ¡tÃ­ |
| 3 | INFO | `detailed_score` parser zÃ¡visÃ­ na CZ formÃ¡tu Chance | Regex je robustnÃ­ pro "LepÅ¡Ã­ z X \| N.mapa" |

### 10.2 SystÃ©movÃ© Rizika

| Riziko | PravdÄ›podobnost | Impact | Mitigace |
|--------|----------------|--------|----------|
| Feed-hub crash | NÃZKÃ | Watchdog â†’ SAFE MODE, stop betting | auto-restart, Telegram alert |
| Azuro smart contract bug | VELMI NÃZKÃ | Potential fund loss | Exposure caps, daily loss limit |
| Scraper selÅ¾e | STÅ˜EDNÃ | Missing data â†’ no edges detected | Multiple scrapers, cross-validation |
| Polygon RPC downtime | NÃZKÃ | Tx failures | Retry logic (8 attempts, 900ms) |
| Stale odds race | STÅ˜EDNÃ | Bet at bad odds | MAX_ODDS_AGE=20s, slippage 3% |

---

## 11. OTÃZKY PRO GEMINI / GPT REVIEW

### A. Jsou thresholds sprÃ¡vnÃ©?

1. **MIN_SCORE_EDGE_PCT = 8%** â€” je to dost vysokÃ©? PÅ™Ã­liÅ¡ nÃ­zkÃ©? Esports majÃ­ 12%, football 18%.
2. **AUTO_BET_MAX_ODDS = 2.00** â€” naÅ¡e data ukazujÃ­ nejlepÅ¡Ã­ ROI v bucketu 1.5â€“2.0. MÄ›li bychom snÃ­Å¾it na 1.80?
3. **DAILY_LOSS_LIMIT = $20** â€” pÅ™i bankrollu $53 je to 38%. Exposure caps dÃ¡vajÃ­ 30% ($15.90). MÄ›l by hard limit bÃ½t $15?
4. **AUTO_BET_STAKE = $3** â€” pÅ™i bankrollu $53 (micro tier, 5% cap = $2.65) â€” trim_stake oÅ™eÅ¾e na $2.65. Je to OK?

### B. Je systÃ©m pÅ™Ã­liÅ¡ konzervativnÃ­?

1. **Football guard ODSTRANÄšN** (goal_diff â‰¥ 2 guard removed) â€” ale min edge 18% je high. SnÃ­Å¾it na 15%?
2. **Tennis guard ODSTRANÄšN** â€” ale $1 stakes a 15% min edge. Je to dost agresivnÃ­ pro data collection?
3. **MIN_MARKET_SOURCES = 2** â€” pro odds anomÃ¡lie. V praxi to blokuje 90% anomÃ¡liÃ­ (vÄ›tÅ¡ina mÃ¡ jen 1 source). SnÃ­Å¾it na 1?
4. **Cross-validation mismatch â†’ HARD SKIP** â€” mÄ›lo by bÃ½t softlimit (0.5Ã— multiplier) mÃ­sto hard skip?

### C. Co dÃ¡l pro Å¡kÃ¡lovÃ¡nÃ­?

1. **Bankroll growth path:** $53 â†’ $150 (small tier) â†’ $500 (medium). Jak rychle realisticky?
2. **NovÃ© scrapers:** 1xBit, Fortuna, Betano â€” pÅ™idÃ¡nÃ­ zvyÅ¡Ã­ cross-validation coverage
3. **Overtime markets:** Pre-match Azuro odds jako arbitrÃ¡Å¾ s live daty â€” implementovat?
4. **Telegram bot commands:** manuÃ¡lnÃ­ bet z mobilu, force-claim, status check
5. **Multi-chain:** Azuro na Gnosis/Chiliz â€” lepÅ¡Ã­ odds nebo vÃ­c marketÅ¯?

### D. BezpeÄnostnÃ­ Audit

1. Je claim pre-filter dostateÄnÃ½? (ovÄ›Å™uje `/check-payout` â†’ claimable && !pending)
2. MÄ›li bychom pÅ™idat rate-limit na auto-bety? (aktuÃ¡lnÄ› jen cooldown 30s per match)
3. Exposure caps pokrÃ½vajÃ­ per-bet, per-condition, per-match, daily. ChybÃ­ per-sport?
4. Feature flags jsou hardcoded `bool` v kÃ³du. MÄ›ly by bÃ½t v config souboru?

---

## 12. KÃ“DOVÃ MAPA (pro AI review)

| Soubor | Å˜Ã¡dky | KlÃ­ÄovÃ© funkce |
|--------|-------|----------------|
| `src/bin/alert_bot.rs` | 6552 | `main()`, `find_score_edges()`, `auto_bet_score_edge()`, `auto_bet_odds_anomaly()`, `trim_stake()`, `cross_validation_multiplier()`, `rebet_allowed()`, `parse_cs2_*()`, `cross_map_momentum_bonus()`, `get_sport_config()`, `sport_auto_bet_guard()`, `get_exposure_caps()` |
| `src/feed_hub.rs` | 1804 | `main()`, sport modely (tennis/football/basketball/esport), WS ingest, `/state`, `/opportunities` |
| `src/azuro_poller.rs` | 648 | GraphQL polling, 12 sportÅ¯, market+odds parsing |
| `executor/index.js` | ~1541 | `/bet`, `/claim`, `/check-payout`, `/my-bets`, `/balance`, on-chain NFT enumeration |
| `userscripts/*.user.js` | ~2400 | Tipsport (v3.0), Chance (v1.1), HLTV (v3.1), FlashScore |

### Feature Flags (alert_bot.rs, line 91â€“99)

```rust
const FF_CHANCE_ROUND_PARSER: bool = true;   // CS2 round parsing from Chance
const FF_CROSS_VALIDATION: bool = true;       // HLTV vs Chance score check
const FF_EXPOSURE_CAPS: bool = true;          // Dynamic bankroll caps
const FF_REBET_ENABLED: bool = true;          // Re-bet on growing edge
const FF_CROSS_MAP_MOMENTUM: bool = true;     // +3% for dominant previous maps
```

---

## 13. CLAIM FLOW (dÅ¯leÅ¾itÃ© pro review)

```
1. Match ends â†’ Oracle resolves condition on-chain
2. Azuro relayer calls Core.resolvePayout(tokenId) â†’ isPaid=true â†’ USDT sent
3. We DON'T need to claim â€” relayer does it automatically (7d timeout)
4. Our claim_check (60s loop) je BACKUP â€” pre-filter ovÄ›Å™Ã­ on-chain readiness
5. Pre-filter: GET /check-payout â†’ must be {claimable: true, pending: false}
6. If chain lags subgraph â†’ token stays in pending_claims, retried next cycle
```

**Fix nasazenÃ½ 2026-02-27:** Pre-filter zabraÅˆuje "$0.00 claim" bug (subgraph ahead of chain).

---

## 14. MATEMATICKÃ MODEL

### Edge Calculation (score-based)

$$
\text{edge} = (\hat{p}_{\text{fair}} - p_{\text{Azuro}}) \times 100 \times c_{\text{cross-val}}
$$

kde:
- $\hat{p}_{\text{fair}}$ = estimated fair probability z live skÃ³re (sport model)
- $p_{\text{Azuro}}$ = implied probability z Azuro odds ($1 / \text{odds}$)
- $c_{\text{cross-val}}$ = cross-validation multiplier (0.0 / 1.0 / 1.25)

### Kelly-inspired Stake

$$
\text{stake} = \min(\text{base\_stake}, \text{per\_bet\_cap}, \text{cond\_room}, \text{match\_room}, \text{daily\_room})
$$

kde `room = cap - current_exposure` a min threshold = $0.50

### Expected Value per Bet

$$
EV = \text{stake} \times (\text{odds} \times \hat{p}_{\text{fair}} - 1)
$$

PÅ™i avg odds 1.75 a avg edge 15%: $EV = 3 \times (1.75 \times 0.65 - 1) = 3 \times 0.1375 = +\$0.41$ per bet.

---

## 15. ZÃVÄšR

### Co funguje âœ…
- Edge detection pÅ™es live score â†’ odds mismatch
- CS2/esports jako primary profit driver (+19â€“33% ROI)
- Multi-scraper data fusion (Tipsport + Chance + HLTV + FlashScore)
- Azuro on-chain betting s full NFT tracking
- 5 safety layers (filters â†’ dedup â†’ exposure â†’ data quality â†’ settlement)
- Feature flags pro incrementÃ¡lnÃ­ upgrades

### Co potÅ™ebuje review âš ï¸
- Football/tennis thresholds (pÅ™Ã­liÅ¡ konzervativnÃ­?)
- MIN_MARKET_SOURCES=2 (blokuje 90% anomÃ¡liÃ­)
- Cross-validation hard skip vs soft penalty
- Bankroll growth strategy ($53 â†’ $150+)

### Co chybÃ­ ğŸ”²
- Per-sport exposure cap
- Config file pro feature flags (teÄ hardcoded)
- More scrapers (1xBit, Fortuna, Betano) pro lepÅ¡Ã­ cross-validation
- ManuÃ¡lnÃ­ Telegram commands
- Overtime/pre-match arbitrÃ¡Å¾

---

**Tento dokument je urÄen pro Gemini Flash 2.5 a GPT-4o review.**  
**ProsÃ­m vyhodnoÅ¥te: thresholds, bezpeÄnost, Å¡kÃ¡lovatelnost, a navrhnÄ›te konkrÃ©tnÃ­ vylepÅ¡enÃ­ s prioritami.**
